mongodb:
  # MongoDB connection settings
  uri: "mongodb://localhost:27017"
  database: "inventory"
  # Collections to watch
  collections:
    - name: "products"
      watch_filter: {}  # Optional aggregation pipeline stages
      topic: "inventory-transactions-topic"
    - name: "transactions"
      watch_filter: {}
      topic: "inventory-updates-topic"
  # Connection options
  options:
    max_pool_size: 100
    min_pool_size: 10
    max_idle_time_ms: 10000
    connect_timeout_ms: 20000
    server_selection_timeout_ms: 30000
    retry_writes: true
    w: "majority"

pubsub:
  # Google Cloud project settings
  project_id: "your-project-id"
  # Default topic settings
  default_topic_settings:
    message_retention_duration: "7d"
    message_storage_policy:
      allowed_persistence_regions:
        - "us-central1"
  # Publisher settings
  publisher:
    batch_settings:
      max_messages: 100
      max_bytes: 1048576  # 1MB
      max_latency: 0.05  # 50ms
    retry_settings:
      initial_retry_delay: 0.1
      retry_delay_multiplier: 1.3
      max_retry_delay: 60
      max_attempts: 5
  # Status topic for heartbeat messages
  status_topic: "connector-status-topic"

firestore:
  # Resume token collection settings
  collection: "resumeTokens"
  # Document TTL in seconds (30 days)
  ttl: 2592000

monitoring:
  # Structured logging settings
  logging:
    level: "INFO"
    format: "json"
    handlers:
      - type: "console"
      - type: "file"
        filename: "connector.log"
        max_bytes: 10485760  # 10MB
        backup_count: 5
  # OpenTelemetry settings
  tracing:
    service_name: "mongo-connector"
    endpoint: "localhost:4317"

health:
  # Health check settings
  endpoints:
    health: "/health"
    readiness: "/readiness"
    metrics: "/metrics"
  # Readiness probe settings
  readiness:
    timeout: 5
    interval: 30
    failure_threshold: 3
  # Heartbeat settings
  heartbeat:
    interval: 30  # seconds
    enabled: true

retry:
  # Connection retry settings
  initial_delay: 1.0
  max_delay: 60.0
  multiplier: 2.0
  jitter: 0.1
  max_retries: 10 